import{t as $,s as Q,a as I,d as De,c as $e,e as Ce}from"../chunks/B7Zs4Suv.js";import{s as ae,h as M,Y as Le,Z as Re,a as je,b as Oe,m as s,l as Me,c as He,r as fe,d as te,g as V,_ as Pe,e as ge,f as we,p as qe,$ as xe,a0 as be,a1 as ze,t as U,a2 as ve,a3 as re,a4 as Je,a5 as ue,a6 as se,a7 as Ve,a8 as ie,a9 as ce,aa as We,ab as Ye,ac as Be,ad as Ge,ae as Fe,af as Ke,K as ye,ag as le,ah as Qe,Q as y,T as O,R as b,N as X,O as ke,q as N,I as W,V as Ue,M as pe,W as q}from"../chunks/DDiMguoB.js";import{i as Y}from"../chunks/BXEidSJ8.js";import{t as Xe,W as B,a as Ze}from"../chunks/9VGkU8Eu.js";import{i as ea}from"../chunks/DKcPPoHM.js";import{p as K}from"../chunks/Bmnq6hHA.js";function Ee(r,e){return e}function aa(r,e,a,n){for(var v=[],d=e.length,u=0;u<d;u++)We(e[u].e,v,!0);var g=d>0&&v.length===0&&a!==null;if(g){var k=a.parentNode;Ye(k),k.append(a),n.clear(),P(r,e[0].prev,e[d-1].next)}Be(v,()=>{for(var E=0;E<d;E++){var h=e[E];g||(n.delete(h.k),P(r,h.prev,h.next)),Ge(h.e,!g)}})}function Te(r,e,a,n,v,d=null){var u=r,g={flags:e,items:new Map,first:null},k=(e&xe)!==0;if(k){var E=r;u=M?ae(Le(E)):E.appendChild(Re())}M&&je();var h=null,L=!1,l=Me(()=>{var c=a();return ze(c)?c:c==null?[]:be(c)});Oe(()=>{var c=s(l),t=c.length;if(L&&t===0)return;L=t===0;let w=!1;if(M){var T=u.data===He;T!==(t===0)&&(u=fe(),ae(u),te(!1),w=!0)}if(M){for(var x=null,D,A=0;A<t;A++){if(V.nodeType===8&&V.data===Pe){u=V,w=!0,te(!1);break}var i=c[A],p=n(i,A);D=Se(V,g,x,null,i,p,A,v,e,a),g.items.set(p,D),x=D}t>0&&ae(fe())}M||ta(c,g,u,v,e,n,a),d!==null&&(t===0?h?ge(h):h=we(()=>d(u)):h!==null&&qe(h,()=>{h=null})),w&&te(!0),s(l)}),M&&(u=V)}function ta(r,e,a,n,v,d,u){var f,j,F,H;var g=(v&Ve)!==0,k=(v&(ie|se))!==0,E=r.length,h=e.items,L=e.first,l=L,c,t=null,w,T=[],x=[],D,A,i,p;if(g)for(p=0;p<E;p+=1)D=r[p],A=d(D,p),i=h.get(A),i!==void 0&&((f=i.a)==null||f.measure(),(w??(w=new Set)).add(i));for(p=0;p<E;p+=1){if(D=r[p],A=d(D,p),i=h.get(A),i===void 0){var G=l?l.e.nodes_start:a;t=Se(G,e,t,t===null?e.first:t.next,D,A,p,n,v,u),h.set(A,t),T=[],x=[],l=t.next;continue}if(k&&ra(i,D,p,v),(i.e.f&re)!==0&&(ge(i.e),g&&((j=i.a)==null||j.unfix(),(w??(w=new Set)).delete(i))),i!==l){if(c!==void 0&&c.has(i)){if(T.length<x.length){var z=x[0],m;t=z.prev;var S=T[0],o=T[T.length-1];for(m=0;m<T.length;m+=1)_e(T[m],z,a);for(m=0;m<x.length;m+=1)c.delete(x[m]);P(e,S.prev,o.next),P(e,t,S),P(e,o,z),l=z,t=o,p-=1,T=[],x=[]}else c.delete(i),_e(i,l,a),P(e,i.prev,i.next),P(e,i,t===null?e.first:t.next),P(e,t,i),t=i;continue}for(T=[],x=[];l!==null&&l.k!==A;)(l.e.f&re)===0&&(c??(c=new Set)).add(l),x.push(l),l=l.next;if(l===null)continue;i=l}T.push(i),t=i,l=i.next}if(l!==null||c!==void 0){for(var _=c===void 0?[]:be(c);l!==null;)(l.e.f&re)===0&&_.push(l),l=l.next;var C=_.length;if(C>0){var R=(v&xe)!==0&&E===0?a:null;if(g){for(p=0;p<C;p+=1)(F=_[p].a)==null||F.measure();for(p=0;p<C;p+=1)(H=_[p].a)==null||H.fix()}aa(e,_,R,h)}}g&&Je(()=>{var J;if(w!==void 0)for(i of w)(J=i.a)==null||J.apply()}),ue.first=e.first&&e.first.e,ue.last=t&&t.e}function ra(r,e,a,n){(n&ie)!==0&&ce(r.v,e),(n&se)!==0?ce(r.i,a):r.i=a}function Se(r,e,a,n,v,d,u,g,k,E){var h=(k&ie)!==0,L=(k&Fe)===0,l=h?L?U(v):ve(v):v,c=(k&se)===0?u:ve(u),t={i:c,v:l,k:d,a:null,e:null,prev:a,next:n};try{return t.e=we(()=>g(r,l,c,E),M),t.e.prev=a&&a.e,t.e.next=n&&n.e,a===null?e.first=t:(a.next=t,a.e.next=t.e),n!==null&&(n.prev=t,n.e.prev=t.e),t}finally{}}function _e(r,e,a){for(var n=r.next?r.next.e.nodes_start:a,v=e?e.e.nodes_start:a,d=r.e.nodes_start;d!==n;){var u=Ke(d);v.before(d),d=u}}function P(r,e,a){e===null?r.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}function me(r,e,a,n){var v=r.__style;if(M||v!==e){var d=Xe(e);(!M||d!==r.getAttribute("style"))&&(d==null?r.removeAttribute("style"):r.style.cssText=d),r.__style=e}return n}var la=$('<div class="gauge-abs svelte-1fa4a5t"><div class="gauge-max svelte-1fa4a5t"></div></div>'),sa=$('<div class="gauge svelte-1fa4a5t"><!> <div class="gauge-overflow svelte-1fa4a5t"><div class="gauge-fill gauge-bg svelte-1fa4a5t"></div> <div class="gauge-fill svelte-1fa4a5t"></div> <div class="gauge-white svelte-1fa4a5t"></div> <div class="gauge-value svelte-1fa4a5t"> </div></div></div>');function he(r,e){ye(e,!1);let a=K(e,"value",8,0),n=K(e,"arrows",8,""),v=K(e,"thresholds",8,"70,90"),d=K(e,"colors",8,"#525C71,#e8523b"),u=U(),g=U(),k=U();le(()=>(W(v()),W(a()),W(d())),()=>{const w=String(v()).split(","),T=w.indexOf(w.find(D=>a()<parseInt(D,10))),x=String(d()).split(",");N(u,x[T]||x[x.length-1])}),le(()=>W(a()),()=>{N(g,(100-a())*1.8)}),le(()=>W(n()),()=>{N(k,n()?String(n()).split(",").map(w=>parseInt(w)*1.8).filter(w=>w>-1):[])}),Qe(),ea();var E=sa(),h=y(E);Te(h,1,()=>s(k),Ee,(w,T)=>{var x=la();X(()=>me(x,`transform:rotate(${s(T)??""}deg)`)),I(w,x)});var L=O(h,2),l=O(y(L),2),c=O(l,4),t=y(c,!0);b(c),b(L),b(E),X(()=>{me(l,`transform:rotate(-${s(g)??""}deg);box-shadow: inset 0 0 0 1em ${s(u)??""};`),Q(t,a())}),I(r,E),ke()}var ia=$('<form class="flex flex-col w-full h-full justify-center items-center p-4 gap-2"><input type="number" name="id" placeholder="Task ID" class="theme-dark-input"> <input type="text" name="name" placeholder="Task Name" class="theme-dark-input"> <input type="text" name="start" placeholder="Start" class="theme-dark-input"> <input type="text" name="end" placeholder="Goal" class="theme-dark-input"> <input type="number" name="priority" placeholder="Priority" class="theme-dark-input"> <button type="submit" class="theme-dark-window-button p-2">Add Task</button></form>'),na=$('<div class="absolute top-0 left-0 w-full h-full flex justify-center items-center bg-[#242424b4] z-50"><div class="absolute flex justify-center items-center theme-dark-container rounded-md justify-self-center"><!></div></div>'),da=$("<p>Loading...</p>"),oa=$('<div class="flex" style="font-size: 4em;"><!></div>'),fa=$("<p>Loading...</p>"),va=$('<div class="flex" style="font-size: 4em;"><!></div>'),ua=$('<img alt="">'),ca=(r,e)=>{fetch(`/api/delete_task?id=${s(e).id}`).then(a=>a.json()).then(a=>{console.log("Task deleted:",a)})},pa=$('<li class="flex flex-row w-full justify-between items-center p-2 pl-4 border-b-1 border-[#242424]"><div class="flex flex-row w-full justify-start items-center"> <div class="flex flex-col w-full ml-5"><p> </p> <p class="text-[#747474]"> </p></div></div> <button aria-label="Delete Task" class="theme-dark-window-button"><div class="p-2 flex flex-col justify-center items-center"><span class="cuida--trash-outline"></span></div></button></li>'),_a=$('<ul class="flex flex-col w-full"></ul>'),ma=$("<p>Loading...</p>"),ha=$('<div class="flex h-full w-full overflow-y-scroll"><!></div>'),ga=$('<!> <div class="flex flex-col md:w-2/3 md:h-full w-full h-1/3 gap-1"><div class="flex flex-row md:h-1/2 h-full w-full mb-1"><div class="flex w-1/2 mr-1 justify-center items-center theme-dark-container rounded-md"><!></div> <div class="flex w-1/2 ml-1 justify-center items-center theme-dark-container rounded-md"><!></div></div> <div class="flex aspect-3/4 w-full mb-1 items-center justify-center theme-dark-container rounded-md"><!></div></div> <div class="flex flex-col md:w-1/3 md:h-full w-full h-full overflow-hidden"><div class="md:flex md:static flex-row h-full w-full mt-1 hidden absolute theme-dark-container rounded-md"><!></div></div>',1);function Ta(r,e){ye(e,!0);let a=q(null),n=q(null),v=q(null),d=q(void 0),u=q(void 0),g=q(void 0),k=q(!1);Ue(async()=>{const m=await fetch("/api/motors");N(a,await m.json(),!0);const S=await fetch("/api/frame");N(n,await S.json(),!0);const o=await fetch("/api/tasks");return N(v,await o.json(),!0),N(d,new EventSource("/api/telemetry"),!0),s(d).addEventListener("motor_updates",_=>{N(a,JSON.parse(_.data),!0)}),N(u,new EventSource("/api/videofeed"),!0),s(u).addEventListener("video_feed",_=>{N(n,JSON.parse(_.data),!0)}),N(g,new EventSource("/api/taskupdates"),!0),s(g).addEventListener("task_update",_=>{N(v,JSON.parse(_.data),!0)}),()=>{s(d)&&s(d).close(),s(u)&&s(u).close(),s(g)&&s(g).close()}});function E(m){m.preventDefault();const S=new FormData(m.target),o={id:S.get("id"),name:S.get("name"),start:S.get("start"),end:S.get("end"),priority:S.get("priority")};fetch(`/api/add_task?id=${o.id}&priority=${o.priority}&name=${o.name}&start=${o.start}&end=${o.end}`).then(_=>_.json()).then(_=>{console.log("Task created:",_),N(k,!1)}).catch(_=>{console.error("Error creating task:",_)})}var h=ga(),L=pe(h);{var l=m=>{var S=na(),o=y(S),_=y(o);B(_,{title:"Add Task",onclick:()=>{N(k,!s(k))},icon:"cuida--x-outline",children:(C,R)=>{var f=ia();Ce("submit",f,E),I(C,f)}}),b(o),b(S),I(m,S)};Y(L,m=>{s(k)&&m(l)})}var c=O(L,2),t=y(c),w=y(t),T=y(w);B(T,{title:"Speed",children:(m,S)=>{var o=oa(),_=y(o);{var C=f=>{he(f,{get value(){return s(a).speed},get arrows(){return s(a).speed}})},R=f=>{var j=da();I(f,j)};Y(_,f=>{s(a)?f(C):f(R,!1)})}b(o),I(m,o)}}),b(w);var x=O(w,2),D=y(x);B(D,{title:"Battery",children:(m,S)=>{var o=va(),_=y(o);{var C=f=>{he(f,{get value(){return s(a).battery},get arrows(){return s(a).battery}})},R=f=>{var j=fa();I(f,j)};Y(_,f=>{s(a)?f(C):f(R,!1)})}b(o),I(m,o)}}),b(x),b(t);var A=O(t,2),i=y(A);B(i,{title:"Camera",children:(m,S)=>{var o=$e(),_=pe(o);{var C=R=>{var f=ua();X(()=>Ze(f,"src",`data:image/jpg;base64,${s(n).frame??""}`)),I(R,f)};Y(_,R=>{s(n)&&R(C)})}I(m,o)}}),b(A),b(c);var p=O(c,2),G=y(p),z=y(G);B(z,{title:"Tasks",onclick:()=>{N(k,!0)},icon:"cuida--plus-outline",children:(m,S)=>{var o=ha(),_=y(o);{var C=f=>{var j=_a();Te(j,21,()=>s(v).tasks,Ee,(F,H)=>{var J=pa(),Z=y(J),ne=y(Z),de=O(ne),ee=y(de),Ae=y(ee,!0);b(ee);var oe=O(ee,2),Ie=y(oe);b(oe),b(de),b(Z);var Ne=O(Z,2);Ne.__click=[ca,H],b(J),X(()=>{Q(ne,`${s(H).id??""} `),Q(Ae,s(H).name),Q(Ie,`${s(H).start??""} - ${s(H).end??""}`)}),I(F,J)}),b(j),I(f,j)},R=f=>{var j=ma();I(f,j)};Y(_,f=>{s(v)?f(C):f(R,!1)})}b(o),I(m,o)}}),b(G),b(p),I(r,h),ke()}De(["click"]);export{Ta as component};
